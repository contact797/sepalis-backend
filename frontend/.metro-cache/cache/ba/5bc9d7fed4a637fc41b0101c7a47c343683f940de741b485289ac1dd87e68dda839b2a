{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":50,"index":129}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"./AuthContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":201},"end":{"line":4,"column":40,"index":241}}],"key":"YmpzODa+dVz64UAAYTI+RwJeEt0=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/SubscriptionContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.SubscriptionProvider = SubscriptionProvider;\n  exports.useSubscription = useSubscription;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _servicesApi = require(_dependencyMap[1], \"../services/api\");\n  var _AuthContext = require(_dependencyMap[2], \"./AuthContext\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const SubscriptionContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function SubscriptionProvider({\n    children\n  }) {\n    _s();\n    const {\n      user\n    } = (0, _AuthContext.useAuth)();\n    const [isPremium, setIsPremium] = (0, _react.useState)(false);\n    const [isTrial, setIsTrial] = (0, _react.useState)(false);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [expiresAt, setExpiresAt] = (0, _react.useState)(null);\n    (0, _react.useEffect)(() => {\n      if (user) {\n        initializeSubscription();\n      }\n    }, [user]);\n    const initializeSubscription = async () => {\n      try {\n        // Vérifier le statut de l'abonnement\n        await checkSubscription();\n      } catch (error) {\n        console.error('Erreur initialisation abonnement:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const checkSubscription = async () => {\n      try {\n        setIsLoading(true);\n\n        // Vérifier depuis le backend\n        const response = await _servicesApi.subscriptionAPI.getStatus();\n        const status = response.data;\n        setIsPremium(status.isActive);\n        setIsTrial(status.isTrial);\n        setExpiresAt(status.expiresAt ? new Date(status.expiresAt) : null);\n        console.log('✅ Statut abonnement:', status);\n      } catch (error) {\n        console.error('Erreur vérification abonnement:', error);\n        // En cas d'erreur, on donne accès (meilleure UX en mode démo)\n        setIsPremium(true);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const startTrial = async () => {\n      try {\n        const response = await _servicesApi.subscriptionAPI.startTrial();\n        if (response.data.success) {\n          setIsPremium(true);\n          setIsTrial(true);\n          setExpiresAt(new Date(response.data.expiresAt));\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('Erreur démarrage essai:', error);\n        return false;\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(SubscriptionContext.Provider, {\n      value: {\n        isPremium,\n        isTrial,\n        isLoading,\n        expiresAt,\n        checkSubscription,\n        startTrial\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }, this);\n  }\n  _s(SubscriptionProvider, \"uQpEX24OyT/ucjRmj7Sea97uQPk=\", false, function () {\n    return [_AuthContext.useAuth];\n  });\n  _c = SubscriptionProvider;\n  function useSubscription() {\n    _s2();\n    const context = (0, _react.useContext)(SubscriptionContext);\n    if (context === undefined) {\n      throw new Error('useSubscription must be used within a SubscriptionProvider');\n    }\n    return context;\n  }\n  _s2(useSubscription, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"SubscriptionProvider\");\n});","lineCount":108,"map":[[10,2,17,0,"exports"],[10,9,17,0],[10,10,17,0,"SubscriptionProvider"],[10,30,17,0],[10,33,17,0,"SubscriptionProvider"],[10,53,17,0],[11,2,98,0,"exports"],[11,9,98,0],[11,10,98,0,"useSubscription"],[11,25,98,0],[11,28,98,0,"useSubscription"],[11,43,98,0],[12,2,1,0],[12,6,1,0,"_react"],[12,12,1,0],[12,15,1,0,"require"],[12,22,1,0],[12,23,1,0,"_dependencyMap"],[12,37,1,0],[13,2,2,0],[13,6,2,0,"_servicesApi"],[13,18,2,0],[13,21,2,0,"require"],[13,28,2,0],[13,29,2,0,"_dependencyMap"],[13,43,2,0],[14,2,4,0],[14,6,4,0,"_AuthContext"],[14,18,4,0],[14,21,4,0,"require"],[14,28,4,0],[14,29,4,0,"_dependencyMap"],[14,43,4,0],[15,2,4,40],[15,6,4,40,"_reactJsxDevRuntime"],[15,25,4,40],[15,28,4,40,"require"],[15,35,4,40],[15,36,4,40,"_dependencyMap"],[15,50,4,40],[16,2,15,0],[16,8,15,6,"SubscriptionContext"],[16,27,15,25],[16,43,15,28],[16,47,15,28,"createContext"],[16,53,15,41],[16,54,15,41,"createContext"],[16,67,15,41],[16,69,15,79,"undefined"],[16,78,15,88],[16,79,15,89],[17,2,17,7],[17,11,17,16,"SubscriptionProvider"],[17,31,17,36,"SubscriptionProvider"],[17,32,17,37],[18,4,17,39,"children"],[19,2,17,79],[19,3,17,80],[19,5,17,82],[20,4,17,82,"_s"],[20,6,17,82],[21,4,18,2],[21,10,18,8],[22,6,18,10,"user"],[23,4,18,15],[23,5,18,16],[23,8,18,19],[23,12,18,19,"useAuth"],[23,24,18,26],[23,25,18,26,"useAuth"],[23,32,18,26],[23,34,18,27],[23,35,18,28],[24,4,19,2],[24,10,19,8],[24,11,19,9,"isPremium"],[24,20,19,18],[24,22,19,20,"setIsPremium"],[24,34,19,32],[24,35,19,33],[24,38,19,36],[24,42,19,36,"useState"],[24,48,19,44],[24,49,19,44,"useState"],[24,57,19,44],[24,59,19,45],[24,64,19,50],[24,65,19,51],[25,4,20,2],[25,10,20,8],[25,11,20,9,"isTrial"],[25,18,20,16],[25,20,20,18,"setIsTrial"],[25,30,20,28],[25,31,20,29],[25,34,20,32],[25,38,20,32,"useState"],[25,44,20,40],[25,45,20,40,"useState"],[25,53,20,40],[25,55,20,41],[25,60,20,46],[25,61,20,47],[26,4,21,2],[26,10,21,8],[26,11,21,9,"isLoading"],[26,20,21,18],[26,22,21,20,"setIsLoading"],[26,34,21,32],[26,35,21,33],[26,38,21,36],[26,42,21,36,"useState"],[26,48,21,44],[26,49,21,44,"useState"],[26,57,21,44],[26,59,21,45],[26,63,21,49],[26,64,21,50],[27,4,22,2],[27,10,22,8],[27,11,22,9,"expiresAt"],[27,20,22,18],[27,22,22,20,"setExpiresAt"],[27,34,22,32],[27,35,22,33],[27,38,22,36],[27,42,22,36,"useState"],[27,48,22,44],[27,49,22,44,"useState"],[27,57,22,44],[27,59,22,58],[27,63,22,62],[27,64,22,63],[28,4,24,2],[28,8,24,2,"useEffect"],[28,14,24,11],[28,15,24,11,"useEffect"],[28,24,24,11],[28,26,24,12],[28,32,24,18],[29,6,25,4],[29,10,25,8,"user"],[29,14,25,12],[29,16,25,14],[30,8,26,6,"initializeSubscription"],[30,30,26,28],[30,31,26,29],[30,32,26,30],[31,6,27,4],[32,4,28,2],[32,5,28,3],[32,7,28,5],[32,8,28,6,"user"],[32,12,28,10],[32,13,28,11],[32,14,28,12],[33,4,30,2],[33,10,30,8,"initializeSubscription"],[33,32,30,30],[33,35,30,33],[33,41,30,33,"initializeSubscription"],[33,42,30,33],[33,47,30,45],[34,6,31,4],[34,10,31,8],[35,8,32,6],[36,8,33,6],[36,14,33,12,"checkSubscription"],[36,31,33,29],[36,32,33,30],[36,33,33,31],[37,6,34,4],[37,7,34,5],[37,8,34,6],[37,15,34,13,"error"],[37,20,34,18],[37,22,34,20],[38,8,35,6,"console"],[38,15,35,13],[38,16,35,14,"error"],[38,21,35,19],[38,22,35,20],[38,57,35,55],[38,59,35,57,"error"],[38,64,35,62],[38,65,35,63],[39,6,36,4],[39,7,36,5],[39,16,36,14],[40,8,37,6,"setIsLoading"],[40,20,37,18],[40,21,37,19],[40,26,37,24],[40,27,37,25],[41,6,38,4],[42,4,39,2],[42,5,39,3],[43,4,41,2],[43,10,41,8,"checkSubscription"],[43,27,41,25],[43,30,41,28],[43,36,41,28,"checkSubscription"],[43,37,41,28],[43,42,41,40],[44,6,42,4],[44,10,42,8],[45,8,43,6,"setIsLoading"],[45,20,43,18],[45,21,43,19],[45,25,43,23],[45,26,43,24],[47,8,45,6],[48,8,46,6],[48,14,46,12,"response"],[48,22,46,20],[48,25,46,23],[48,31,46,29,"subscriptionAPI"],[48,43,46,44],[48,44,46,44,"subscriptionAPI"],[48,59,46,44],[48,60,46,45,"getStatus"],[48,69,46,54],[48,70,46,55],[48,71,46,56],[49,8,47,6],[49,14,47,12,"status"],[49,20,47,18],[49,23,47,21,"response"],[49,31,47,29],[49,32,47,30,"data"],[49,36,47,34],[50,8,49,6,"setIsPremium"],[50,20,49,18],[50,21,49,19,"status"],[50,27,49,25],[50,28,49,26,"isActive"],[50,36,49,34],[50,37,49,35],[51,8,50,6,"setIsTrial"],[51,18,50,16],[51,19,50,17,"status"],[51,25,50,23],[51,26,50,24,"isTrial"],[51,33,50,31],[51,34,50,32],[52,8,51,6,"setExpiresAt"],[52,20,51,18],[52,21,51,19,"status"],[52,27,51,25],[52,28,51,26,"expiresAt"],[52,37,51,35],[52,40,51,38],[52,44,51,42,"Date"],[52,48,51,46],[52,49,51,47,"status"],[52,55,51,53],[52,56,51,54,"expiresAt"],[52,65,51,63],[52,66,51,64],[52,69,51,67],[52,73,51,71],[52,74,51,72],[53,8,53,6,"console"],[53,15,53,13],[53,16,53,14,"log"],[53,19,53,17],[53,20,53,18],[53,42,53,40],[53,44,53,42,"status"],[53,50,53,48],[53,51,53,49],[54,6,55,4],[54,7,55,5],[54,8,55,6],[54,15,55,13,"error"],[54,20,55,18],[54,22,55,20],[55,8,56,6,"console"],[55,15,56,13],[55,16,56,14,"error"],[55,21,56,19],[55,22,56,20],[55,55,56,53],[55,57,56,55,"error"],[55,62,56,60],[55,63,56,61],[56,8,57,6],[57,8,58,6,"setIsPremium"],[57,20,58,18],[57,21,58,19],[57,25,58,23],[57,26,58,24],[58,6,59,4],[58,7,59,5],[58,16,59,14],[59,8,60,6,"setIsLoading"],[59,20,60,18],[59,21,60,19],[59,26,60,24],[59,27,60,25],[60,6,61,4],[61,4,62,2],[61,5,62,3],[62,4,64,2],[62,10,64,8,"startTrial"],[62,20,64,18],[62,23,64,21],[62,29,64,21,"startTrial"],[62,30,64,21],[62,35,64,51],[63,6,65,4],[63,10,65,8],[64,8,66,6],[64,14,66,12,"response"],[64,22,66,20],[64,25,66,23],[64,31,66,29,"subscriptionAPI"],[64,43,66,44],[64,44,66,44,"subscriptionAPI"],[64,59,66,44],[64,60,66,45,"startTrial"],[64,70,66,55],[64,71,66,56],[64,72,66,57],[65,8,68,6],[65,12,68,10,"response"],[65,20,68,18],[65,21,68,19,"data"],[65,25,68,23],[65,26,68,24,"success"],[65,33,68,31],[65,35,68,33],[66,10,69,8,"setIsPremium"],[66,22,69,20],[66,23,69,21],[66,27,69,25],[66,28,69,26],[67,10,70,8,"setIsTrial"],[67,20,70,18],[67,21,70,19],[67,25,70,23],[67,26,70,24],[68,10,71,8,"setExpiresAt"],[68,22,71,20],[68,23,71,21],[68,27,71,25,"Date"],[68,31,71,29],[68,32,71,30,"response"],[68,40,71,38],[68,41,71,39,"data"],[68,45,71,43],[68,46,71,44,"expiresAt"],[68,55,71,53],[68,56,71,54],[68,57,71,55],[69,10,72,8],[69,17,72,15],[69,21,72,19],[70,8,73,6],[71,8,75,6],[71,15,75,13],[71,20,75,18],[72,6,76,4],[72,7,76,5],[72,8,76,6],[72,15,76,13,"error"],[72,20,76,18],[72,22,76,20],[73,8,77,6,"console"],[73,15,77,13],[73,16,77,14,"error"],[73,21,77,19],[73,22,77,20],[73,47,77,45],[73,49,77,47,"error"],[73,54,77,52],[73,55,77,53],[74,8,78,6],[74,15,78,13],[74,20,78,18],[75,6,79,4],[76,4,80,2],[76,5,80,3],[77,4,82,2],[77,24,83,4],[77,28,83,4,"_reactJsxDevRuntime"],[77,47,83,4],[77,48,83,4,"jsxDEV"],[77,54,83,4],[77,56,83,5,"SubscriptionContext"],[77,75,83,24],[77,76,83,25,"Provider"],[77,84,83,33],[78,6,84,6,"value"],[78,11,84,11],[78,13,84,13],[79,8,85,8,"isPremium"],[79,17,85,17],[80,8,86,8,"isTrial"],[80,15,86,15],[81,8,87,8,"isLoading"],[81,17,87,17],[82,8,88,8,"expiresAt"],[82,17,88,17],[83,8,89,8,"checkSubscription"],[83,25,89,25],[84,8,90,8,"startTrial"],[85,6,91,6],[85,7,91,8],[86,6,91,8,"children"],[86,14,91,8],[86,16,93,7,"children"],[87,4,93,15],[88,6,93,15,"fileName"],[88,14,93,15],[88,16,93,15,"_jsxFileName"],[88,28,93,15],[89,6,93,15,"lineNumber"],[89,16,93,15],[90,6,93,15,"columnNumber"],[90,18,93,15],[91,4,93,15],[91,11,94,34],[91,12,94,35],[92,2,96,0],[93,2,96,1,"_s"],[93,4,96,1],[93,5,17,16,"SubscriptionProvider"],[93,25,17,36],[94,4,17,36],[94,12,18,19,"useAuth"],[94,24,18,26],[94,25,18,26,"useAuth"],[94,32,18,26],[95,2,18,26],[96,2,18,26,"_c"],[96,4,18,26],[96,7,17,16,"SubscriptionProvider"],[96,27,17,36],[97,2,98,7],[97,11,98,16,"useSubscription"],[97,26,98,31,"useSubscription"],[97,27,98,31],[97,29,98,34],[98,4,98,34,"_s2"],[98,7,98,34],[99,4,99,2],[99,10,99,8,"context"],[99,17,99,15],[99,20,99,18],[99,24,99,18,"useContext"],[99,30,99,28],[99,31,99,28,"useContext"],[99,41,99,28],[99,43,99,29,"SubscriptionContext"],[99,62,99,48],[99,63,99,49],[100,4,100,2],[100,8,100,6,"context"],[100,15,100,13],[100,20,100,18,"undefined"],[100,29,100,27],[100,31,100,29],[101,6,101,4],[101,12,101,10],[101,16,101,14,"Error"],[101,21,101,19],[101,22,101,20],[101,82,101,80],[101,83,101,81],[102,4,102,2],[103,4,103,2],[103,11,103,9,"context"],[103,18,103,16],[104,2,104,0],[105,2,104,1,"_s2"],[105,5,104,1],[105,6,98,16,"useSubscription"],[105,21,98,31],[106,2,98,31],[106,6,98,31,"_c"],[106,8,98,31],[107,2,98,31,"$RefreshReg$"],[107,14,98,31],[107,15,98,31,"_c"],[107,17,98,31],[108,0,98,31],[108,3]],"functionMap":{"names":["<global>","SubscriptionProvider","useEffect$argument_0","initializeSubscription","checkSubscription","startTrial","useSubscription"],"mappings":"AAA;OCgB;YCO;GDI;iCEE;GFS;4BGE;GHqB;qBIE;GJgB;CDgB;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}