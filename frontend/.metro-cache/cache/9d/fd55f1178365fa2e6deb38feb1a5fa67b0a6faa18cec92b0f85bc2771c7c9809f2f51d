{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":69,"index":69}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"@react-native-community/netinfo","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":70},"end":{"line":2,"column":54,"index":124}}],"key":"PqZcYTlMIVnzFjdViPzMiGUu7Hg=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":125},"end":{"line":3,"column":54,"index":179}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"syncService\",{enumerable:!0,get:function(){return h}});var t=e(r(d[0])),s=e(r(d[1])),n=r(d[2]);const c='@sepalis_tasks',o='@sepalis_plants',l='@sepalis_zones',u='@sepalis_last_sync',h={isOnline:async()=>(await s.default.fetch()).isConnected??!1,async syncAll(){if(await this.isOnline())try{const[e,s,h]=await Promise.all([n.tasksAPI.getTasks(),n.plantsAPI.getUserPlants(),n.zonesAPI.getZones()]);await Promise.all([t.default.setItem(c,JSON.stringify(e.data)),t.default.setItem(o,JSON.stringify(s.data)),t.default.setItem(l,JSON.stringify(h.data)),t.default.setItem(u,(new Date).toISOString())]),console.log('\\u2705 Synchronisation compl\\xe8te r\\xe9ussie')}catch(e){throw console.error('\\u274c Erreur synchronisation:',e),e}else console.log('Hors ligne - synchronisation annul\\xe9e')},async getTasks(){if(!await this.isOnline())return await this.getCachedTasks();try{const e=await n.tasksAPI.getTasks();return await t.default.setItem(c,JSON.stringify(e.data)),e.data}catch(e){return console.log('Erreur serveur, utilisation du cache'),await this.getCachedTasks()}},async getPlants(){if(!await this.isOnline())return await this.getCachedPlants();try{const e=await n.plantsAPI.getUserPlants();return await t.default.setItem(o,JSON.stringify(e.data)),e.data}catch(e){return console.log('Erreur serveur, utilisation du cache'),await this.getCachedPlants()}},async getZones(){if(!await this.isOnline())return await this.getCachedZones();try{const e=await n.zonesAPI.getZones();return await t.default.setItem(l,JSON.stringify(e.data)),e.data}catch(e){return console.log('Erreur serveur, utilisation du cache'),await this.getCachedZones()}},async getCachedTasks(){try{const e=await t.default.getItem(c);return e?JSON.parse(e):[]}catch(e){return console.error('Erreur lecture cache tasks:',e),[]}},async getCachedPlants(){try{const e=await t.default.getItem(o);return e?JSON.parse(e):[]}catch(e){return console.error('Erreur lecture cache plants:',e),[]}},async getCachedZones(){try{const e=await t.default.getItem(l);return e?JSON.parse(e):[]}catch(e){return console.error('Erreur lecture cache zones:',e),[]}},async getLastSync(){try{const e=await t.default.getItem(u);return e?new Date(e):null}catch(e){return console.error('Erreur lecture last sync:',e),null}},async clearCache(){try{await t.default.multiRemove([c,o,l,u]),console.log('\\u2705 Cache vid\\xe9')}catch(e){console.error('\\u274c Erreur vidage cache:',e)}},subscribeToNetworkChanges:e=>s.default.addEventListener(t=>{e(t.isConnected??!1)})}});","lineCount":1,"map":[[1,143,12,0,"Object"],[1,150,12,0,"defineProperty"],[1,165,12,0,"_e"],[1,168,12,0],[1,183,12,0,"enumerable"],[1,195,12,0],[1,197,12,0,"get"],[1,201,12,0],[1,219,12,0,"syncService"],[1,220,12,0],[1,224,1,0],[1,228,1,0,"AsyncStorage"],[1,230,1,0,"_interopDefault"],[1,232,1,0,"r"],[1,234,1,0,"d"],[1,236,1,0],[1,241,2,0,"NetInfo"],[1,243,2,0,"_interopDefault"],[1,245,2,0,"r"],[1,247,2,0,"d"],[1,249,2,0],[1,254,3,0,"_api"],[1,256,3,0,"r"],[1,258,3,0,"d"],[1,260,3,0],[1,264,5,0],[1,270,5,6,"CACHE_KEYS"],[1,272,6,9],[1,289,5,6,"CACHE_KEYS"],[1,291,7,10],[1,309,5,6,"CACHE_KEYS"],[1,311,8,9],[1,328,5,6,"CACHE_KEYS"],[1,330,9,13],[1,351,12,13,"syncService"],[1,353,12,27],[1,354,16,2,"async"],[1,363,16,16,"isOnline"],[1,379,17,24,"NetInfo"],[1,381,17,31,"default"],[1,389,17,32,"fetch"],[1,398,18,17,"isConnected"],[1,412,18,32],[1,414,24,2],[1,427,24,8,"syncAll"],[1,430,27,4],[1,439,25,27,"this"],[1,444,25,32,"isOnline"],[1,455,32,4],[1,459,34,6],[1,465,34,13,"tasksResponse"],[1,467,34,28,"plantsResponse"],[1,469,34,44,"zonesResponse"],[1,478,34,67,"Promise"],[1,486,34,75,"all"],[1,490,34,79],[1,491,35,8,"tasksAPI"],[1,493,35,16,"tasksAPI"],[1,502,35,17,"getTasks"],[1,513,36,8,"plantsAPI"],[1,515,36,17,"plantsAPI"],[1,525,36,18,"getUserPlants"],[1,541,37,8,"zonesAPI"],[1,543,37,16,"zonesAPI"],[1,552,37,17,"getZones"],[1,571,41,12,"Promise"],[1,579,41,20,"all"],[1,583,41,24],[1,584,42,8,"AsyncStorage"],[1,586,42,20,"default"],[1,594,42,21,"setItem"],[1,602,42,29,"CACHE_KEYS"],[1,604,42,47,"JSON"],[1,609,42,52,"stringify"],[1,619,42,62,"tasksResponse"],[1,621,42,76,"data"],[1,628,43,8,"AsyncStorage"],[1,630,43,20,"default"],[1,638,43,21,"setItem"],[1,646,43,29,"CACHE_KEYS"],[1,648,43,48,"JSON"],[1,653,43,53,"stringify"],[1,663,43,63,"plantsResponse"],[1,665,43,78,"data"],[1,672,44,8,"AsyncStorage"],[1,674,44,20,"default"],[1,682,44,21,"setItem"],[1,690,44,29,"CACHE_KEYS"],[1,692,44,47,"JSON"],[1,697,44,52,"stringify"],[1,707,44,62,"zonesResponse"],[1,709,44,76,"data"],[1,716,45,8,"AsyncStorage"],[1,718,45,20,"default"],[1,726,45,21,"setItem"],[1,734,45,29,"CACHE_KEYS"],[1,737,45,51],[1,741,45,55,"Date"],[1,747,45,62,"toISOString"],[1,764,48,6,"console"],[1,772,48,14,"log"],[1,776,48,18],[1,824,49,4],[1,825,49,6],[1,831,49,13,"error"],[1,834,51,6],[1,840,50,6,"console"],[1,848,50,14,"error"],[1,854,50,20],[1,887,50,49,"error"],[1,890,51,12,"error"],[1,891,52,4],[1,897,28,6,"console"],[1,905,28,14,"log"],[1,909,28,18],[1,951,53,2],[1,953,58,2],[1,967,58,8,"getTasks"],[1,970,61,4],[1,980,59,27,"this"],[1,985,59,32,"isOnline"],[1,996,71,6],[1,1009,71,19,"this"],[1,1014,71,24,"getCachedTasks"],[1,1031,62,6],[1,1035,63,8],[1,1041,63,14,"response"],[1,1049,63,31,"tasksAPI"],[1,1051,63,39,"tasksAPI"],[1,1060,63,40,"getTasks"],[1,1071,65,8],[1,1084,64,14,"AsyncStorage"],[1,1086,64,26,"default"],[1,1094,64,27,"setItem"],[1,1102,64,35,"CACHE_KEYS"],[1,1104,64,53,"JSON"],[1,1109,64,58,"stringify"],[1,1119,64,68,"response"],[1,1121,64,77,"data"],[1,1128,65,15,"response"],[1,1130,65,24,"data"],[1,1134,66,6],[1,1135,66,8],[1,1141,66,15,"error"],[1,1144,68,8],[1,1151,67,8,"console"],[1,1159,67,16,"log"],[1,1163,67,20],[1,1209,68,21,"this"],[1,1214,68,26,"getCachedTasks"],[1,1230,69,6],[1,1231,73,2],[1,1233,78,2],[1,1248,78,8,"getPlants"],[1,1251,81,4],[1,1261,79,27,"this"],[1,1266,79,32,"isOnline"],[1,1277,91,6],[1,1290,91,19,"this"],[1,1295,91,24,"getCachedPlants"],[1,1313,82,6],[1,1317,83,8],[1,1323,83,14,"response"],[1,1331,83,31,"plantsAPI"],[1,1333,83,40,"plantsAPI"],[1,1343,83,41,"getUserPlants"],[1,1359,85,8],[1,1372,84,14,"AsyncStorage"],[1,1374,84,26,"default"],[1,1382,84,27,"setItem"],[1,1390,84,35,"CACHE_KEYS"],[1,1392,84,54,"JSON"],[1,1397,84,59,"stringify"],[1,1407,84,69,"response"],[1,1409,84,78,"data"],[1,1416,85,15,"response"],[1,1418,85,24,"data"],[1,1422,86,6],[1,1423,86,8],[1,1429,86,15,"error"],[1,1432,88,8],[1,1439,87,8,"console"],[1,1447,87,16,"log"],[1,1451,87,20],[1,1497,88,21,"this"],[1,1502,88,26,"getCachedPlants"],[1,1519,89,6],[1,1520,93,2],[1,1522,98,2],[1,1536,98,8,"getZones"],[1,1539,101,4],[1,1549,99,27,"this"],[1,1554,99,32,"isOnline"],[1,1565,111,6],[1,1578,111,19,"this"],[1,1583,111,24,"getCachedZones"],[1,1600,102,6],[1,1604,103,8],[1,1610,103,14,"response"],[1,1618,103,31,"zonesAPI"],[1,1620,103,39,"zonesAPI"],[1,1629,103,40,"getZones"],[1,1640,105,8],[1,1653,104,14,"AsyncStorage"],[1,1655,104,26,"default"],[1,1663,104,27,"setItem"],[1,1671,104,35,"CACHE_KEYS"],[1,1673,104,53,"JSON"],[1,1678,104,58,"stringify"],[1,1688,104,68,"response"],[1,1690,104,77,"data"],[1,1697,105,15,"response"],[1,1699,105,24,"data"],[1,1703,106,6],[1,1704,106,8],[1,1710,106,15,"error"],[1,1713,108,8],[1,1720,107,8,"console"],[1,1728,107,16,"log"],[1,1732,107,20],[1,1778,108,21,"this"],[1,1783,108,26,"getCachedZones"],[1,1799,109,6],[1,1800,113,2],[1,1802,118,2],[1,1822,118,8,"getCachedTasks"],[1,1825,119,4],[1,1829,120,6],[1,1835,120,12,"cached"],[1,1843,120,27,"AsyncStorage"],[1,1845,120,39,"default"],[1,1853,120,40,"getItem"],[1,1861,120,48,"CACHE_KEYS"],[1,1864,121,6],[1,1871,121,13,"cached"],[1,1873,121,22,"JSON"],[1,1878,121,27,"parse"],[1,1884,121,33,"cached"],[1,1887,121,43],[1,1889,122,4],[1,1890,122,6],[1,1896,122,13,"error"],[1,1899,124,6],[1,1906,123,6,"console"],[1,1914,123,14,"error"],[1,1920,123,20],[1,1950,123,51,"error"],[1,1953,124,13],[1,1955,125,4],[1,1956,126,2],[1,1958,131,2],[1,1979,131,8,"getCachedPlants"],[1,1982,132,4],[1,1986,133,6],[1,1992,133,12,"cached"],[1,2000,133,27,"AsyncStorage"],[1,2002,133,39,"default"],[1,2010,133,40,"getItem"],[1,2018,133,48,"CACHE_KEYS"],[1,2021,134,6],[1,2028,134,13,"cached"],[1,2030,134,22,"JSON"],[1,2035,134,27,"parse"],[1,2041,134,33,"cached"],[1,2044,134,43],[1,2046,135,4],[1,2047,135,6],[1,2053,135,13,"error"],[1,2056,137,6],[1,2063,136,6,"console"],[1,2071,136,14,"error"],[1,2077,136,20],[1,2108,136,52,"error"],[1,2111,137,13],[1,2113,138,4],[1,2114,139,2],[1,2116,144,2],[1,2136,144,8,"getCachedZones"],[1,2139,145,4],[1,2143,146,6],[1,2149,146,12,"cached"],[1,2157,146,27,"AsyncStorage"],[1,2159,146,39,"default"],[1,2167,146,40,"getItem"],[1,2175,146,48,"CACHE_KEYS"],[1,2178,147,6],[1,2185,147,13,"cached"],[1,2187,147,22,"JSON"],[1,2192,147,27,"parse"],[1,2198,147,33,"cached"],[1,2201,147,43],[1,2203,148,4],[1,2204,148,6],[1,2210,148,13,"error"],[1,2213,150,6],[1,2220,149,6,"console"],[1,2228,149,14,"error"],[1,2234,149,20],[1,2264,149,51,"error"],[1,2267,150,13],[1,2269,151,4],[1,2270,152,2],[1,2272,157,2],[1,2289,157,8,"getLastSync"],[1,2292,158,4],[1,2296,159,6],[1,2302,159,12,"lastSync"],[1,2310,159,29,"AsyncStorage"],[1,2312,159,41,"default"],[1,2320,159,42,"getItem"],[1,2328,159,50,"CACHE_KEYS"],[1,2331,160,6],[1,2338,160,13,"lastSync"],[1,2340,160,24],[1,2344,160,28,"Date"],[1,2349,160,33,"lastSync"],[1,2352,160,45],[1,2356,161,4],[1,2357,161,6],[1,2363,161,13,"error"],[1,2366,163,6],[1,2373,162,6,"console"],[1,2381,162,14,"error"],[1,2387,162,20],[1,2415,162,49,"error"],[1,2418,163,13],[1,2422,164,4],[1,2423,165,2],[1,2425,170,2],[1,2441,170,8,"clearCache"],[1,2444,171,4],[1,2454,172,12,"AsyncStorage"],[1,2456,172,24,"default"],[1,2464,172,25,"multiRemove"],[1,2476,172,37],[1,2477,173,8,"CACHE_KEYS"],[1,2479,174,8,"CACHE_KEYS"],[1,2481,175,8,"CACHE_KEYS"],[1,2483,176,8,"CACHE_KEYS"],[1,2487,178,6,"console"],[1,2495,178,14,"log"],[1,2499,178,18],[1,2522,179,4],[1,2523,179,6],[1,2529,179,13,"error"],[1,2532,180,6,"console"],[1,2540,180,14,"error"],[1,2546,180,20],[1,2576,180,46,"error"],[1,2578,181,4],[1,2579,182,2],[1,2581,187,2,"subscribeToNetworkChanges"],[1,2607,187,28,"callback"],[1,2610,188,24,"NetInfo"],[1,2612,188,31,"default"],[1,2620,188,32,"addEventListener"],[1,2637,188,49,"state"],[1,2641,189,6,"callback"],[1,2643,189,15,"state"],[1,2645,189,21,"isConnected"],[1,2659,189,36],[1,2664,194,2],[1,2667]],"functionMap":{"names":["<global>","isOnline","syncAll","getTasks","getPlants","getZones","getCachedTasks","getCachedPlants","getCachedZones","getLastSync","clearCache","subscribeToNetworkChanges","NetInfo.addEventListener$argument_0"],"mappings":"AAA;ECe;GDG;EEK;GF6B;EGK;GHe;EIK;GJe;EKK;GLe;EMK;GNQ;EOK;GPQ;EQK;GRQ;ESK;GTQ;EUK;GVY;EWK;iDCC;KDE;GXG"},"hasCjsExports":false},"type":"js/module"}]}